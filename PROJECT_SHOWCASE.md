# 📚 企业知识库 RAG 智能问答系统

> 基于检索增强生成（RAG）技术构建的企业年报智能问答系统 | 简历项目展示

[![Streamlit](https://img.shields.io/badge/Streamlit-FF4B4B?style=for-the-badge&logo=streamlit&logoColor=white)](https://streamlit.io/)
[![Python](https://img.shields.io/badge/Python-3.8+-3776AB?style=for-the-badge&logo=python&logoColor=white)](https://www.python.org/)
[![RAG](https://img.shields.io/badge/RAG-检索增强生成-FF6B6B?style=for-the-badge)](https://en.wikipedia.org/wiki/Retrieval-augmented_generation)

---

## 🎯 项目概述

这是一个**企业级RAG（检索增强生成）智能问答系统**，专门用于处理企业年报PDF文档并回答相关问题。系统实现了完整的RAG流程，从PDF解析到向量检索，再到LLM生成答案，支持多公司、多数据库架构。

### 核心价值
- 📄 **智能文档理解**：自动解析复杂的PDF年报，提取结构化信息
- 🔍 **高效检索**：结合向量检索和LLM重排序，精准定位相关信息
- 💬 **智能问答**：基于检索到的上下文，生成准确、可追溯的答案
- 🏗️ **可扩展架构**：多数据库路由设计，支持大规模企业知识库

---

## ✨ 核心功能

### 1. PDF智能解析
- 使用Docling工具进行PDF结构化解析
- 保留表格、文本、页码等元数据
- 支持并行处理，提高效率

### 2. 混合检索策略
- **向量检索**：基于语义相似度的FAISS检索
- **BM25检索**：传统关键词检索
- **LLM重排序**：使用大模型对检索结果精确排序
- **父文档检索**：先检索摘要，再获取完整上下文

### 3. 多数据库架构
- 每家企业独立向量数据库
- 智能路由到对应数据库
- 支持多公司对比查询

### 4. 结构化输出
- Chain-of-Thought（CoT）分步推理
- JSON Schema结构化输出
- 自动引用页码验证
- 支持多种问题类型（布尔、数字、文本、列表）

### 5. Web交互界面
- 基于Streamlit的现代化UI
- 实时问答交互
- 显示推理过程和引用来源
- 历史对话记录

---

## 🏗️ 技术架构

```
┌─────────────────────────────────────────────────────────┐
│                    用户界面（Streamlit）                  │
└──────────────────────┬──────────────────────────────────┘
                       │
┌──────────────────────▼──────────────────────────────────┐
│              问题处理与路由（QuestionsProcessor）          │
│  • 公司名提取  • 问题路由  • 多公司对比识别                │
└──────────────────────┬──────────────────────────────────┘
                       │
        ┌──────────────┴──────────────┐
        │                             │
┌───────▼────────┐          ┌────────▼────────┐
│   检索阶段     │          │   LLM重排序      │
│ • 向量检索     │          │ • 相关性评分     │
│ • BM25检索     │          │ • 结果重排序     │
│ • 混合检索     │          └─────────────────┘
└───────┬────────┘
        │
┌───────▼─────────────────────────────────────────────────┐
│              向量数据库（FAISS）                         │
│  • 多公司独立数据库  • Embedding索引  • 快速检索         │
└─────────────────────────────────────────────────────────┘
```

### 数据流程

```
PDF文档 
  ↓ [pdf_parsing.py]
结构化JSON（文本+表格+元数据）
  ↓ [tables_serialization.py] (可选)
表格序列化（Markdown格式）
  ↓ [parsed_reports_merging.py]
规整报告（每页文本列表）
  ↓ [text_splitter.py]
文本分块（500 tokens/chunk）
  ↓ [ingestion.py]
向量数据库（FAISS索引）
  ↓
用户问题
  ↓ [retrieval.py + reranking.py]
检索上下文
  ↓ [questions_processing.py]
LLM生成答案
  ↓
结构化答案（JSON + 引用页码）
```

---

## 🛠️ 技术栈

### 核心技术
- **Python 3.8+** - 主要开发语言
- **Streamlit** - Web界面框架
- **FAISS** - 向量数据库（Facebook AI Similarity Search）
- **LangChain** - LLM应用框架
- **Docling** - PDF解析工具

### AI/ML技术
- **DashScope/OpenAI** - Embedding生成和LLM推理
- **通义千问/GPT-4** - 大语言模型
- **向量检索** - 语义相似度搜索
- **LLM Reranking** - 检索结果重排序

### 数据处理
- **Pandas** - 数据处理
- **PyPDF2** - PDF处理
- **Tiktoken** - Token计数
- **JSON Repair** - JSON修复

---

## 📊 项目亮点

### 1. 多策略检索融合
- 向量检索：语义理解，找到相关文档
- BM25检索：关键词匹配，精确查找
- LLM重排序：智能排序，提升精度

### 2. 智能分块策略
- 保留表格完整性
- 基于章节语义切分
- 支持父文档检索

### 3. 结构化输出设计
- 分步推理过程（CoT）
- 自动页码引用验证
- 支持多种问题类型

### 4. 可扩展架构
- 多数据库路由
- 并行处理支持
- 模块化设计

---

## 🚀 快速开始

### 在线演示
🌐 **访问链接**：[你的Streamlit Cloud链接]

### 本地运行

```bash
# 1. 克隆项目
git clone https://github.com/你的用户名/你的仓库.git
cd RAG-Challenge-2-main

# 2. 安装依赖
pip install -r requirements.txt

# 3. 配置环境变量
# 创建 .env 文件，添加：
# DASHSCOPE_API_KEY=your_api_key_here

# 4. 运行Web界面
streamlit run app.py
```

### 使用步骤

1. **初始化系统**
   - 在侧边栏选择数据集
   - 配置检索参数（Top N、Reranking等）
   - 点击"初始化系统"

2. **提问**
   - 输入问题（需包含公司名，用引号括起来）
   - 选择问题类型
   - 点击"提交问题"

3. **查看结果**
   - 最终答案
   - 推理过程
   - 引用页码
   - 相关文档

---

## 📸 项目截图

### 系统界面
![系统界面](添加截图路径)

### 问答示例
![问答示例](添加截图路径)

### 架构图
![架构图](添加架构图路径)

---

## 📈 项目数据

- **支持文档类型**：PDF年报（多公司）
- **向量数据库**：FAISS索引
- **检索精度**：Top-10 + LLM重排序
- **响应时间**：平均3-5秒/问题
- **支持问题类型**：布尔、数字、文本、列表

---

## 🎓 学习价值

这个项目展示了：
- ✅ 完整的RAG系统实现
- ✅ 多策略检索融合
- ✅ LLM应用开发实践
- ✅ 向量数据库使用
- ✅ Web应用开发
- ✅ 系统架构设计

---

## 📝 项目文档

- [系统架构梳理](RAG系统架构梳理.md)
- [Streamlit界面使用说明](Streamlit界面使用说明.md)
- [部署指南](项目部署指南.md)
- [模块说明](docs/src_modules_overview.md)

---

## 🔗 相关链接

- **GitHub仓库**：[你的GitHub链接]
- **在线演示**：[你的Streamlit链接]
- **技术博客**：[如果有的话]

---

## 👤 作者

[你的名字]

---

## 📄 License

MIT License

---

**💡 提示**：这是一个简历展示项目，展示了RAG系统的完整实现和最佳实践。

