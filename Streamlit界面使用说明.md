# Streamlit 可视化界面使用说明

## 🚀 启动应用

```bash
cd RAG-Challenge-2-main
streamlit run app.py
```

应用会自动在浏览器中打开（通常是 `http://localhost:8501`）

## 📋 使用步骤

### 1. 初始化系统
- 在左侧边栏选择数据集（test_set 或 erc2_set）
- 配置参数（可选）：
  - 启用/禁用 LLM Reranking
  - 调整检索数量 (Top N)
  - 调整 Reranking 样本数
- 点击 **"初始化系统"** 按钮

### 2. 提问
- 在主界面输入问题
- **重要**：问题中必须包含公司名称（用引号括起来）
  - ✅ 正确示例：`"Mercia Asset Management PLC"年报中是否提到了并购？`
  - ✅ 正确示例：`"中芯国际"2024年主营业务是什么？`
  - ❌ 错误示例：`年报中是否提到了并购？`（缺少公司名）

### 3. 选择问题类型
- **string**：开放性问题（默认）
- **boolean**：是否类问题
- **number**：数字类问题
- **names**：名称列表类问题

### 4. 查看答案
系统会显示：
- 🎯 **最终答案**：高亮显示
- 📊 **推理摘要**：简要总结
- 🔍 **详细分析过程**：分步推理（可展开）
- 📄 **相关页码**：引用的页面
- 📚 **文档引用**：PDF 引用信息（可展开）

## 💡 使用技巧

1. **问题格式**：公司名必须用引号括起来，例如 `"公司名"问题内容`
2. **首次使用**：需要先初始化系统（加载向量数据库）
3. **网络问题**：如果遇到连接错误，系统会自动重试（最多3次）
4. **答案格式**：支持 Markdown 渲染，分步分析会格式化显示

## ⚙️ 配置说明

### 数据集选择
- **test_set**：测试数据集（5个PDF报告）
- **erc2_set**：完整比赛数据集

### 高级配置
- **LLM Reranking**：启用后使用 LLM 对检索结果重排序，提高精度但速度较慢
- **检索数量 (Top N)**：从向量数据库检索的文档数量（建议10-30）
- **Reranking 样本数**：用于重排序的初始检索数量（建议30）

## 🔧 常见问题

### Q: 提示"未找到公司名称"
A: 确保问题中包含公司名称，并用引号括起来

### Q: 初始化失败
A: 检查：
1. `.env` 文件是否配置了 `DASHSCOPE_API_KEY`
2. 数据集路径是否正确
3. 向量数据库是否已生成（`databases/vector_dbs/` 目录）

### Q: 答案显示 "N/A"
A: 可能是：
1. 检索到的文档中没有相关信息
2. 问题类型选择不正确
3. 尝试增加检索数量 (Top N)

## 📝 示例问题

```
"Mercia Asset Management PLC"年报中是否提到了并购？
"中芯国际"2024年主营业务的主要内容是什么？
"万科企业股份有限公司"2022年总资产是多少？
```

---

**注意**：首次运行 Streamlit 时可能会提示输入邮箱，直接按回车跳过即可。

